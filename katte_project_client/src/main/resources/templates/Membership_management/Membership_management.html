<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <title>íšŒì› ê´€ë¦¬</title>
  <link rel="stylesheet" href="/css/fragments/Sidebar.css" />
  <link rel="stylesheet" href="/css/Membership_management/Membership_management.css" />
</head>
<body>
<!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   1) ì‚¬ì´ë“œë°” (ê¸°ì¡´ê³¼ ë™ì¼)
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<!-- ì‚¬ì´ë“œë°” HTML ë¶„ë¦¬ -->
<div th:replace="~{Fragments/Sidebar :: sidebar}"></div>

<div class="wrapper">

  <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     2) ë©”ì¸ ì½˜í…ì¸  ì˜ì—­
     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div class="content">

    <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       2-1) ìƒë‹¨: íƒ­ + â€œì´ íšŒì› ë³´ê¸°â€ í† ê¸€
       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <div class="tab-toggle-wrapper">
      <div class="tab-container">
        <a class="tab" th:classappend="${activeTab == 'member-area'} ? ' active'" href="/admin/user_view">íšŒì› ê´€ë¦¬</a>
        <a class="tab" th:classappend="${activeTab == 'review-area'} ? ' active'" href="/admin/inspection_view">ê²€ìˆ˜ ê´€ë¦¬</a>
        <div class="tab" th:classappend="${activeTab == 'report-area'} ? ' active'" data-target="report-area">ì‹ ê³  ê´€ë¦¬</div>
      </div>

      <!-- íšŒì› ì „ìš© ì»¨íŠ¸ë¡¤: ë“œë¡­ë‹¤ìš´ + ê²€ìƒ‰ì°½ + ì´ íšŒì› -->
      <div th:if="${activeTab == 'member-area'}"> <!--íšŒì› ëª©ë¡ì—ì„œë§Œ ë³´ì´ë„ë¡ ì²˜ë¦¬-->
        <div class="view-toggle-container">
          <button id="viewToggleBtn" class="view-toggle-btn">
            <span class="view-label">ì´ íšŒì› ë³´ê¸°</span>
            <span class="view-arrow">â¬‡ï¸</span>
          </button>
          <div id="viewDropdown" class="view-dropdown">
            <div class="view-option selected" data-value="all">
              <span class="checkmark">âœ”</span>
              <span class="option-label">ì´ íšŒì› ë³´ê¸°</span>
            </div>
            <div class="view-option" data-value="reported">
              <span class="checkmark"></span>
              <span class="option-label">ì‹ ê³ ëœ íšŒì› ë³´ê¸°</span>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       2-2) ê²€ìƒ‰ì°½ + ì´ íšŒì› ìˆ˜
       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <div th:if="${activeTab == 'member-area'}"> <!--íšŒì› ëª©ë¡ì—ì„œë§Œ ë³´ì´ë„ë¡ ì²˜ë¦¬-->
      <div class="search-area">
        <div class="total-count" th:text="'ì´ íšŒì› ' + ${userCount} + 'ëª…'">ì´   íšŒì› 0ëª…</div>

        <!-- ê²€ìƒ‰ í¼ -->
        <form method="get" th:action="@{/admin/user_search}" class="search-input">
          <label>
            <input type="text" name="keyword"
                   placeholder="ë‹‰ë„¤ì„ í˜¹ì€ ê³„ì • IDë¥¼ ê²€ìƒ‰í•˜ì„¸ìš”"
                   th:value="${param.keyword}" />
          </label>
          <button type="submit">ê²€ìƒ‰</button>
        </form>
      </div>
    </div>
    <!-- íšŒì› ê²€ìƒ‰ ê²°ê³¼ í˜ì´ì§€ë„¤ì´ì…˜ -->

    <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       2-3) íšŒì›ê´€ë¦¬ ì„¹ì…˜
       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <div id="member-area" th:classappend="${activeTab != 'member-area'} ? ' hidden'">
      <table class="member-table">
        <thead>
        <tr>
          <th>ë‹‰ë„¤ì„</th>
          <th>ê³„ì • ID</th>
          <th>íšŒì› ê°€ì…ì¼</th>
          <th>ê²Œì‹œê¸€ &amp; ëŒ“ê¸€ ìˆ˜</th>
          <th>íšŒì› ìƒíƒœ ê´€ë¦¬</th>
        </tr>
        </thead>
        <tbody>
        <!-- â”€â”€â”€ í…Œì´ë¸” í–‰ (row-all) â”€â”€â”€ -->
        <tr th:each="user : ${userList}"
            th:class="${user.ban_status == 'ê³„ì • ì •ì§€'} ? 'row-reported' : 'row-all'">
          <td th:text="${user.nickname}">ë‹‰ë„¤ì„</td>
          <td th:text="${user.email_id}">ê³„ì •ID</td>
          <td th:text="${#dates.format(user.registration_date, 'yyyy-MM-dd')}">ê°€ì…ì¼</td>
          <td class="post-cell">
            <span th:text="'ê²Œì‹œê¸€: ' + ${user.style_count} + 'ê°œ'"></span><br />
            <span th:text="'ëŒ“ê¸€: ' + ${user.comment_count} + 'ê°œ'"></span>
          </td>
          <td class="status-cell">
            <div class="status-wrapper">
               <span class="status-display"
                     th:if="${user.ban_status == 'ê³„ì • ì •ì§€'}">ì •ì§€</span>
                <span class="status-display"
                    th:if="${user.ban_status != 'ê³„ì • ì •ì§€'}"
                    th:text="${user.restriction_status != null} ? ${user.restriction_status} : 'ì •ìƒ'">ìƒíƒœ</span>
              <button class="edit-btn">ìˆ˜ì •í•˜ê¸°</button>
            </div>
            <div class="status-popup">
              <ul class="status-menu">
                <!-- ìƒíƒœ ì œì–´ ë²„íŠ¼ë“¤ -->
                <li data-value="ì •ìƒ"
                    th:attr="data-userid=${user.user_id}, data-ban=${user.ban_status}, data-restrict=${user.restriction_status}"
                    onclick="handleStatusAction(this)">
                  ì •ìƒ
                </li>
                <li data-value="ìŠ¤íƒ€ì¼ ì‘ì„± ì œí•œ"
                    th:attr="data-userid=${user.user_id}, data-ban=${user.ban_status}, data-restrict=${user.restriction_status}"
                    onclick="handleStatusAction(this)">
                  ìŠ¤íƒ€ì¼ ì‘ì„± ì œí•œ
                </li>

                <li data-value="ëŒ“ê¸€ ì‘ì„± ì œí•œ"
                    th:attr="data-userid=${user.user_id}, data-ban=${user.ban_status}, data-restrict=${user.restriction_status}"
                    onclick="handleStatusAction(this)">
                  ëŒ“ê¸€ ì‘ì„± ì œí•œ
                </li>

                <li data-value="ê³„ì • ì •ì§€"
                    th:attr="data-userid=${user.user_id}, data-ban=${user.ban_status}, data-restrict=${user.restriction_status}"
                    onclick="handleStatusAction(this)">
                  ê³„ì • ì •ì§€
                </li>
              </ul>

              <!-- ìƒíƒœ ë³€ê²½ìš© ìˆ¨ê²¨ì§„ í¼ -->
              <form id="statusForm" method="post" action="/admin/change_status" style="display:none;"></form>

              <script>
                function handleStatusAction(element) {
                  const userId = element.dataset.userid;
                  const banStatus = element.dataset.ban || "";
                  const restrictStatus = element.dataset.restrict || "";
                  const actionType = element.dataset.value;

                  const form = document.getElementById("statusForm");
                  const currentStatus = banStatus + restrictStatus;

                  if (actionType === 'ê³„ì • ì •ì§€') {
                    if (currentStatus.includes("ê³„ì • ì •ì§€")) {
                      alert("ì´ë¯¸ ì •ì§€ëœ íšŒì›ì…ë‹ˆë‹¤.");
                      return;
                    }
                    if (confirm("ì •ë§ë¡œ í•´ë‹¹ ê³„ì •ì„ ì •ì§€ì‹œí‚¤ì‹œê² ìŠµë‹ˆê¹Œ?")) {
                      submitStatusForm(userId, "ban");
                    }

                  } else if (actionType === 'ì •ìƒ') {
                    if (banStatus === 'ê³„ì • ì •ì§€') {
                      if (confirm("ì •ì§€ ìƒíƒœë¥¼ í•´ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
                        submitStatusForm(userId, "unban");
                      }
                    } else if (restrictStatus) {
                      if (confirm("ì œí•œ ìƒíƒœë¥¼ í•´ì œí•˜ê³  ì •ìƒìœ¼ë¡œ ë˜ëŒë¦¬ì‹œê² ìŠµë‹ˆê¹Œ?")) {
                        submitStatusForm(userId, "normal"); //ì „ì²´ ì œí•œ í•´ì œ
                      }
                    } else {
                      alert("ì´ë¯¸ ì •ìƒ ìƒíƒœì…ë‹ˆë‹¤.");
                    }
                  } else if (actionType === 'ìŠ¤íƒ€ì¼ ì‘ì„± ì œí•œ' || actionType === 'ëŒ“ê¸€ ì‘ì„± ì œí•œ') {

                    const isStyleRestricted = restrictStatus.includes("ìŠ¤íƒ€ì¼ ì‘ì„± ì œí•œ") || restrictStatus.includes("ê²Œì‹œê¸€ ì‘ì„± ì œí•œ");
                    const isCommentRestricted = restrictStatus.includes("ëŒ“ê¸€ ì‘ì„± ì œí•œ");

                    if (actionType === 'ìŠ¤íƒ€ì¼ ì‘ì„± ì œí•œ') {
                      if (isStyleRestricted) {
                        if (confirm(`${actionType} ìƒíƒœë¥¼ í•´ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                          submitStatusForm(userId, "normal", 1); // ê°œë³„ í•´ì œ
                        }
                        return;
                      }
                    }

                    if (actionType === 'ëŒ“ê¸€ ì‘ì„± ì œí•œ') {
                      if (isCommentRestricted) {
                        if (confirm(`${actionType} ìƒíƒœë¥¼ í•´ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                          submitStatusForm(userId, "normal", 2); // ê°œë³„ í•´ì œ
                        }
                        return;
                      }
                    }
                    // âœ… ì—¬ê¸°ì— typeKey ì •ì˜ ì¶”ê°€
                    const typeKey = actionType === 'ìŠ¤íƒ€ì¼ ì‘ì„± ì œí•œ' ? 'style' : 'comment';
                    // ìƒˆë¡œ ì œí•œ ì¶”ê°€
                    const days = prompt("ì œí•œ ì¼ìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”:");
                    if (!days || isNaN(days)) return alert("ìœ íš¨í•œ ìˆ«ìë¥¼ ì…ë ¥í•˜ì„¸ìš”.");

                    submitStatusForm(userId, typeKey, parseInt(days));
                  }
                }

                function submitStatusForm(userId, actionType, stopDays = null) {
                  const form = document.getElementById("statusForm");
                  form.innerHTML = `
                    <input name="user_id" value="${userId}">
                    <input name="action_type" value="${actionType}">
                    ${stopDays !== null ? `<input name="stop_days" value="${stopDays}">` : ""}`;
                  form.submit(); // ì´í›„ ì„œë²„ ì‘ë‹µì—ì„œ redirectë¡œ ë°˜ì˜ë¨
                }
              </script>
            </div>
          </td>
        </tr>
        </tbody>
      </table>

      <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         2-4) íšŒì› ê´€ë¦¬ í˜ì´ì§• ë„¤ë¹„ê²Œì´ì…˜
         â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
      <!-- íšŒì› ê²€ìƒ‰ ê²°ê³¼ í˜ì´ì§€ë„¤ì´ì…˜ -->
      <div class="pagination"
           th:if="${param.keyword != null and memberTotalPages > 1}">
        <a th:href="@{/admin/user_search(page=${memberCurrentPage - 1}, keyword=${param.keyword})}"
           th:if="${memberCurrentPage > 1}" class="prev">PREV</a>
        <a th:each="p : ${#numbers.sequence(1, memberTotalPages)}"
           th:href="@{/admin/user_search(page=${p}, keyword=${param.keyword})}"
           th:text="${p}"
           th:classappend="${p == memberCurrentPage} ? 'current-page' : ''">
        </a>
        <a th:href="@{/admin/user_search(page=${memberCurrentPage + 1}, keyword=${param.keyword})}"
           th:if="${memberCurrentPage < memberTotalPages}" class="next">NEXT</a>
      </div>

      <!-- ì¼ë°˜ íšŒì› ëª©ë¡ í˜ì´ì§€ë„¤ì´ì…˜ -->
      <div class="pagination"
           th:if="${param.keyword == null and memberTotalPages > 1}">
        <a th:href="@{/admin/user_view(page=${memberCurrentPage - 1})}"
           th:if="${memberCurrentPage > 1}" class="prev">PREV</a>
        <a th:each="p : ${#numbers.sequence(1, memberTotalPages)}"
           th:href="@{/admin/user_view(page=${p})}"
           th:text="${p}"
           th:classappend="${p == memberCurrentPage} ? 'current-page' : ''">
        </a>
        <a th:href="@{/admin/user_view(page=${memberCurrentPage + 1})}"
           th:if="${memberCurrentPage < memberTotalPages}" class="next">NEXT</a>
      </div>
    </div>

    <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       2-5) ê²€ìˆ˜ê´€ë¦¬ ì„¹ì…˜
       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <div id="review-area" th:classappend="${activeTab != 'review-area'} ? ' hidden'">
      <div class="section-count" th:text="'ê²€ìˆ˜ ë‚´ì—­ ' + ${inspectionCount} + 'ê±´'">ê²€ìˆ˜ ë‚´ì—­ 0ê±´</div>
      <table class="review-table">
        <thead>
        <tr>
          <th>ìƒí’ˆëª…</th>
          <th>ìƒí’ˆ íƒ€ì´í‹€</th>
          <th>íŒë§¤ì ì•„ì´ë””</th>
          <th>ë“±ë¡ì¼</th>
          <th>ê²€ìˆ˜ ìƒíƒœ</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="item : ${inspectionList}">
          <td>
            <span th:text="${item.product_name}">ìƒí’ˆëª…</span><br/>
            <button class="detail-btn" th:attr="data-id=${item.check_result_id}">ìƒì„¸ ë³´ê¸°</button>
          </td>
          <td th:text="${item.shortform_title}">íƒ€ì´í‹€</td>
          <td th:text="${item.seller_email}">íŒë§¤ì</td>
          <td th:text="${#dates.format(item.check_start_day, 'yyyy-MM-dd')}">ë“±ë¡ì¼</td>
          <td class="review-cell">
            <!-- ê²€ìˆ˜ì¤‘ì¼ ë•Œë§Œ ë²„íŠ¼ -->
            <th:block th:if="${item.check_step.name() == 'IN_PROGRESS'}">
              <button class="review-complete-btn" th:attr="data-id=${item.check_result_id}">ê²€ìˆ˜ ì™„ë£Œ</button>
              <button class="review-fail-btn" th:attr="data-id=${item.check_result_id}">ê²€ìˆ˜ ê¸°ì¤€ ë¯¸ë‹¬</button>
            </th:block>

            <!-- ê²€ìˆ˜ ì™„ë£Œ í…ìŠ¤íŠ¸ -->
            <th:block th:if="${item.check_step.name() == 'COMPLETED'}">
              <span style="color: green; font-weight: bold;">ê²€ìˆ˜ ì™„ë£Œ</span>
            </th:block>

            <!-- ê²€ìˆ˜ ì‹¤íŒ¨ í…ìŠ¤íŠ¸ -->
            <th:block th:if="${item.check_step.name() == 'RETURNED'}">
              <span style="color: red; font-weight: bold;">ê²€ìˆ˜ ê¸°ì¤€ ë¯¸ë‹¬</span>
            </th:block>
          </td>
        </tr>
        </tbody>
      </table>
      <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         2-6) ê²€ìˆ˜ ê´€ë¦¬ í˜ì´ì§• ë„¤ë¹„ê²Œì´ì…˜
         â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
      <div class="pagination" th:if="${reviewTotalPages != null and reviewTotalPages > 1}">
        <!-- PREV ë²„íŠ¼ -->
        <a th:href="@{/admin/inspection_view(page=${reviewCurrentPage - 1})}"
           th:if="${reviewCurrentPage > 1}" class="prev">PREV</a>

        <!-- í˜ì´ì§€ ë²ˆí˜¸ -->
        <a th:each="p : ${#numbers.sequence(1, reviewTotalPages)}"
           th:href="@{/admin/inspection_view(page=${p})}"
           th:text="${p}"
           th:classappend="${p == reviewCurrentPage} ? 'current-page' : ''">
        </a>

        <!-- NEXT ë²„íŠ¼ -->
        <a th:href="@{/admin/inspection_view(page=${reviewCurrentPage + 1})}"
           th:if="${reviewCurrentPage < reviewTotalPages}" class="next">NEXT</a>
      </div>
    </div>
    <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         2-7) ì‹ ê³  ê´€ë¦¬ ì„¹ì…˜
         â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <div id="report-area" th:classappend="${activeTab != 'report-area'} ? ' hidden'">
      <!-- â–¶ ë§¨ ìœ„: ì‹ ê³  ê±´ìˆ˜ -->
      <div class="section-count">ì‹ ê³  ê±´ìˆ˜ 10ê±´</div>

      <!-- â–¶ ì‹ ê³  ê´€ë¦¬ í…Œì´ë¸” -->
      <table class="report-table">
        <thead>
        <tr>
          <th>ë¶„ë¥˜</th>
          <th>ì‹ ê³ ë¶„ë¥˜</th>
          <th>ì‹ ê³ ê¸€</th>
          <th>ì‘ì„±ì</th>
          <th>ì‹ ê³ íšŸìˆ˜</th>
          <th>ì‹ ê³ ì</th>
          <th>ì‹ ê³ ë‚ ì§œ</th>
          <th>ì‚­ì œ</th>
        </tr>
        </thead>
        <tbody>
        <tr>
          <td>ê²Œì‹œê¸€ ì‹ ê³ </td>
          <td>í™ë³´ ë° ìƒì—…ì ì¸ ë‚´ìš©ì´ ë“¤ì–´ê°„ ê¸€</td>
          <td>ë¹µëŒ•ì´ê°€ì˜ˆë¸Œë„¤ì—¬</td>
          <td>minQQQQQ1</td>
          <td>ê²Œì‹œê¸€: 1íšŒ<br/>ëŒ“ê¸€: 1íšŒ</td>
          <td>wedsã…_23xXy</td>
          <td>2025-01-13</td>
          <td><button class="delete-btn">ì‚­ì œ</button></td>
        </tr>
        <tr>
          <td>ëŒ“ê¸€ ì‹ ê³ </td>
          <td>ì•…ì˜ì  ìš•ì„¤ì´ í¬í•¨ëœ ê¸€</td>
          <td>ì˜¤ ê°œë³„ë£¨ë ë‹ww</td>
          <td>sungkeun0728</td>
          <td>ê²Œì‹œê¸€: 2íšŒ<br/>ëŒ“ê¸€: 3íšŒ</td>
          <td>gdxLLILxXXXx</td>
          <td>2025-01-14</td>
          <td><button class="delete-btn">ì‚­ì œ</button></td>
        </tr>
        <!-- â€¦ ì¶”ê°€ í–‰ ê°€ëŠ¥ â€¦ -->
        </tbody>
      </table>
      <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         2-8) ì‹ ê³  ê´€ë¦¬ í˜ì´ì§€ ë„¤ì´ì…˜
         â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
      <!-- â–¶ í˜ì´ì§• ë„¤ë¹„ê²Œì´ì…˜ (ê¸°ì¡´ê³¼ ë™ì¼í•œ ìŠ¤íƒ€ì¼) -->
      <div class="pagination">
        <a href="#" class="prev">PREV</a>
        <span class="current-page">1</span>
        <a href="#">2</a>
        <a href="#">3</a>
        <a href="#" class="next">NEXT</a>
      </div>
    </div>
  </div>
  <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     3) ê²Œì‹œê¸€ ëª¨ë‹¬
     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div id="postsModal" class="modal">
    <div class="modal-overlay"></div>
    <div class="modal-box">
      <button class="modal-close">&times;</button>
      <div class="modal-header">
        <h2 class="modal-title"></h2>
        <button class="modal-count"></button>
      </div>
      <table class="modal-table">
        <thead>
        <tr>
          <th>ê¸€ ë²ˆí˜¸</th>
          <th>ê¸€ ì œëª©</th>
          <th>ì‘ì„±ì¼</th>
          <th>ì¡°íšŒìˆ˜</th>
          <th>ì¢‹ì•„ìš”</th>
        </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>
  <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     4) ëŒ“ê¸€ ëª¨ë‹¬
     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div id="commentsModal" class="modal">
    <div class="modal-overlay"></div>
    <div class="modal-box">
      <button class="modal-close">&times;</button>
      <div class="modal-header">
        <h2 class="modal-title"></h2>
        <button class="modal-count"></button>
      </div>
      <table class="modal-table">
        <thead>
        <tr>
          <th>ê¸€ ë²ˆí˜¸</th>
          <th>ì‘ì„±í•œ ëŒ“ê¸€</th>
          <th>ì‘ì„±ì¼</th>
        </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     5) JavaScript (íƒ­ ì „í™˜ + ë“œë¡­ë‹¤ìš´ + ìƒíƒœ íŒì—… + ëª¨ë‹¬ + ê²€ìˆ˜ê´€ë¦¬)
     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <script>

  </script>


  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // (1) íƒ­ ì „í™˜
      document.querySelectorAll('.tab').forEach(tab => {
        tab.addEventListener('click', () => {
          // íƒ­ ìŠ¤íƒ€ì¼ í† ê¸€
          document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
          tab.classList.add('active');
          // ì„¹ì…˜ í‘œì‹œ í† ê¸€
          ['member-area','review-area','report-area'].forEach(id => {
            document.getElementById(id).classList.toggle('hidden', tab.dataset.target !== id);
          });
        });
      });

      // (2) â€œì´ íšŒì› ë³´ê¸°â€ ë“œë¡­ë‹¤ìš´ (íšŒì› ê´€ë¦¬ íƒ­ì—ì„œë§Œ ì‚¬ìš©)
      const viewToggleBtn = document.getElementById('viewToggleBtn');
      const viewDropdown  = document.getElementById('viewDropdown');
      const options       = viewDropdown.querySelectorAll('.view-option');
      const viewLabel     = viewToggleBtn.querySelector('.view-label');
      let currentView = 'all';

      viewToggleBtn.addEventListener('click', e => {
        e.stopPropagation();
        const isOpen = viewDropdown.style.display === 'block';
        viewDropdown.style.display = isOpen ? 'none' : 'block';
        viewToggleBtn.classList.toggle('open', !isOpen);
      });

      options.forEach(opt => {
        opt.addEventListener('click', () => {
          const v = opt.dataset.value;
          if (v !== currentView) {
            options.forEach(o => o.classList.remove('selected'));
            opt.classList.add('selected');
            viewLabel.innerText = opt.querySelector('.option-label').innerText;
            currentView = v;
            document.querySelectorAll('#member-area .member-table tbody tr').forEach(r => {
              r.style.display = (v === 'all' || r.classList.contains('row-reported')) ? '' : 'none';
            });
          }
          viewDropdown.style.display = 'none';
          viewToggleBtn.classList.remove('open');
        });
      });

      document.addEventListener('click', () => {
        if (viewDropdown.style.display === 'block') {
          viewDropdown.style.display = 'none';
          viewToggleBtn.classList.remove('open');
        }
      });

      // (3) â€œìˆ˜ì •í•˜ê¸°â€ ë²„íŠ¼ â†’ ìƒíƒœ íŒì—…
      document.querySelectorAll('.status-cell').forEach(cell => {
        const btn   = cell.querySelector('.edit-btn');
        const popup = cell.querySelector('.status-popup');
        const disp  = cell.querySelector('.status-display');

        btn.addEventListener('click', e => {
          e.stopPropagation();
          document.querySelectorAll('.status-popup').forEach(p => p.style.display = 'none');
          popup.style.display = popup.style.display === 'block' ? 'none' : 'block';
        });

        popup.querySelectorAll('li').forEach(li => {
          li.addEventListener('click', () => {
            popup.querySelectorAll('li').forEach(o => o.classList.remove('selected'));
            li.classList.add('selected');
            popup.style.display = 'none';
          });
        });
      });

      document.addEventListener('click', () => {
        document.querySelectorAll('.status-popup').forEach(popup => {
          if (popup.style.display === 'block') popup.style.display = 'none';
        });
      });

      // (4) ì˜ˆì‹œ ë°ì´í„°
      const postData = {
        need_u_neko: [
          { no:109, title:'ì˜¤ëŠ˜ì˜ ë£© ë„˜ ê·€ì—¬ì´ì‰', date:'2024ë…„ 10ì›” 17ì¼ 22ì‹œ 13ë¶„', views:143, likes:12 },
          { no:231, title:'ë„ˆë¬´ë„ˆë¬´ ì¶¥ë˜ ë‚ ì´ì—ìš¤', date:'2024ë…„ 11ì›” 01ì¼ 22ì‹œ 13ë¶„', views:3423, likes:43 },
          { no:353, title:'ìƒì¼ ê¸°ë… ootd', date:'2024ë…„ 12ì›” 17ì¼ 22ì‹œ 13ë¶„', views:1217, likes:121 },
          { no:356, title:'ë‚ ì”¨ ì¢‹ë‹¤ ã…‡ã…‡', date:'2025ë…„ 01ì›” 23ì¼ 22ì‹œ 13ë¶„', views:43, likes:3 }
        ],
        jyuhebs: [], sdsafdssfd: [], dfwwwwwbabo: [], sndfbsfwad: []
      };
      const commentData = {
        need_u_neko: [
          { no:32, comment:'ì—¬ê¸° ì–´ë””ì¸ê°€ìš”? ë„ˆë¬´ ì˜ˆë»ìš©', date:'2024ë…„ 10ì›” 17ì¼ 22ì‹œ 13ë¶„' },
          { no:1321, comment:'í•µ ì € ì˜· ì‚¬ê³  ì‹¶ì–´ì„œ ê³ ë¯¼í•˜ê³  ìˆì—ˆëŠ”ë°~+â™¥', date:'2024ë…„ 11ì›” 01ì¼ 22ì‹œ 13ë¶„' },
          { no:232, comment:'ì‚´ì°Œ ë“¬ë»ìš© ã…ã…', date:'2024ë…„ 12ì›” 17ì¼ 22ì‹œ 13ë¶„' },
          { no:2415, comment:'ì˜¤ëŠ˜ ë£© ë„ˆë¬´ ë§¹í•´ìš©', date:'2025ë…„ 01ì›” 23ì¼ 22ì‹œ 13ë¶„' }
        ],
        jyuhebs: [], sdsafdssfd: [], dfwwwwwbabo: [], sndfbsfwad: []
      };

      // (5) ëª¨ë‹¬ ê³µí†µ ì…‹ì—…
      function setupModal(id) {
        const m = document.getElementById(id);
        m.querySelector('.modal-overlay').onclick = () => m.style.display = 'none';
        m.querySelector('.modal-close').onclick   = () => m.style.display = 'none';
      }
      setupModal('postsModal');
      setupModal('commentsModal');

      // (6) ê²Œì‹œê¸€ í´ë¦­ â†’ postsModal
      document.querySelectorAll('.post-count').forEach(el => {
        el.style.cursor = 'pointer';
        el.onclick = () => {
          const uid = el.closest('tr').cells[1].innerText.trim();
          const list = postData[uid] || [];
          const m    = document.getElementById('postsModal');
          m.querySelector('.modal-title').innerText = `${uid}ë‹˜ì˜ ì‘ì„± ê²Œì‹œê¸€`;
          m.querySelector('.modal-count').innerText = `ì‘ì„±í•œ ê²Œì‹œê¸€ ìˆ˜: ì´ ${String(list.length).padStart(2,'0')}ê°œ`;
          const tb = m.querySelector('tbody'); tb.innerHTML = '';
          list.forEach(p => {
            tb.insertAdjacentHTML('beforeend',
                    `<tr>
            <td>${p.no}</td>
            <td>${p.title}</td>
            <td>${p.date}</td>
            <td>${p.views}</td>
            <td>${p.likes}</td>
          </tr>`
            );
          });
          m.style.display = 'block';
        };
      });

      // (7) ëŒ“ê¸€ í´ë¦­ â†’ commentsModal
      document.querySelectorAll('.comment-count').forEach(el => {
        el.style.cursor = 'pointer';
        el.onclick = () => {
          const uid = el.closest('tr').cells[1].innerText.trim();
          const list = commentData[uid] || [];
          const m    = document.getElementById('commentsModal');
          m.querySelector('.modal-title').innerText = `${uid}ë‹˜ì˜ ì‘ì„± ëŒ“ê¸€`;
          m.querySelector('.modal-count').innerText = `ì‘ì„±í•œ ëŒ“ê¸€ ìˆ˜: ì´ ${String(list.length).padStart(2,'0')}ê°œ`;
          const tb = m.querySelector('tbody'); tb.innerHTML = '';
          list.forEach(c => {
            tb.insertAdjacentHTML('beforeend',
                    `<tr>
            <td>${c.no}</td>
            <td>${c.comment}</td>
            <td>${c.date}</td>
          </tr>`
            );
          });
          m.style.display = 'block';
        };
      });

      // (8) ê²€ìˆ˜ê´€ë¦¬ â€“ ê²€ìˆ˜ ìƒíƒœ ë²„íŠ¼ ì²˜ë¦¬
      document.querySelectorAll('.review-complete-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          const id = btn.dataset.id;
          if (confirm('ê²€ìˆ˜ë¥¼ ì™„ë£Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
            fetch(`http://localhost:9000/admin/inspection/complete?check_result_id=${id}`, {
              method: 'PATCH'
            }).then(res => {
              if (res.ok) {
                // ğŸ‘‡ ë²„íŠ¼ ì˜ì—­ì„ 'ê²€ìˆ˜ ì™„ë£Œ'ë¡œ ëŒ€ì²´
                const td = btn.closest('td');
                td.innerHTML = '<span style="color: green; font-weight: bold;">ê²€ìˆ˜ ì™„ë£Œ</span>';
              } else {
                alert('ê²€ìˆ˜ ì™„ë£Œ ì²˜ë¦¬ ì‹¤íŒ¨');
              }
            });
          }
        });
      });

      document.querySelectorAll('.review-fail-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          const id = btn.dataset.id;
          if (confirm('ê²€ìˆ˜ ê¸°ì¤€ ë¯¸ë‹¬ ì²˜ë¦¬ë¥¼ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
            fetch(`http://localhost:9000/admin/inspection/fail?check_result_id=${id}`, {
              method: 'PATCH'
            }).then(res => {
              if (res.ok) {
                const td = btn.closest('td');
                td.innerHTML = '<span style="color: red; font-weight: bold;">ê²€ìˆ˜ ê¸°ì¤€ ë¯¸ë‹¬</span>';
              } else {
                alert('ê²€ìˆ˜ ì‹¤íŒ¨ ì²˜ë¦¬ ì‹¤íŒ¨');
              }
            });
          }
        });
      });

      // (9) ì‹ ê³ ê´€ë¦¬ â€“ ì‚­ì œ ë²„íŠ¼ (í–¥í›„ ë¡œì§ ì—°ê²°)
      document.querySelectorAll('.delete-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          // TODO: ì‚­ì œ API í˜¸ì¶œ ë˜ëŠ” í–‰ ì œê±°
          console.log('ì‚­ì œ í´ë¦­:', btn.closest('tr'));
        });
      });
    });
  </script>
</div>
</body>
</html>
