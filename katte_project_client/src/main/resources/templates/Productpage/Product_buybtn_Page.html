<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<link rel="stylesheet" href="/css/Productpage/Product_buybtn_Page.css" />
<body>
<!-- ì‚¬ì´ë“œë°” CSS ë¶„ë¦¬ ìŠ¤íƒ€ì¼ ì ìš© -->
<link rel="stylesheet" href="/css/fragments/Sidebar.css" />
<!-- ì‚¬ì´ë“œë°” HTML ë¶„ë¦¬ -->
<div th:replace="Fragments/Sidebar :: sidebar"></div>

<div class="wrapper">

  <input type="hidden" id="product-meta"
         th:data-product-id="${product.product_id}"
         th:data-brand="${product.brand_name}"
         th:data-name="${product.product_name}" />

  <div class="div">êµ¬ë§¤ ì…ì°°í•˜ê¸°</div>
  <img class="rectangle-1594" src="rectangle-15940.svg" />
  <div class="rectangle-1613"></div>
  <div class="rectangle-1604"></div>
  <img class="image" src="" />
  <div class="nike-x-lil-yachty-us-force-1-low-white-and-midnight-navy"
       th:text="${product.product_name}">
  </div>
  <div class="_270" th:text="'ì˜µì…˜: ' + ${size}"></div>
  <div class="div2">ì¦‰ì‹œ êµ¬ë§¤ê°€</div>
  <div class="_178-000" th:text=" ${price} + 'â‚©'"></div>
  <div class="div3">ì¦‰ì‹œ íŒë§¤ê°€</div>
  <div th:if="${#lists.isEmpty(sell_price_list)}">
    <div class="_168-000">ì •ë³´ ì—†ìŒ</div>
  </div>
  <div th:unless="${#lists.isEmpty(sell_price_list)}" th:each="sp : ${sell_price_list}">
    <div th:if="${sp.auction_size_value == size}"
         th:text="${#numbers.formatInteger(sp.price, 3, 'COMMA')} + ' â‚©'"
         class="_168-000">
    </div>
  </div>
  <div class="line-262"></div>
  <div class="rectangle-1614"></div>
    <div class="rectangle-1615"></div>
  <a th:href="@{/product/payment}">
  <div class="rectangle-1616"></div>
  </a>
  <div class="div4">êµ¬ë§¤ ì…ì°°</div>
  <a th:href="@{/product/payment}">
  <div class="div5">ì¦‰ì‹œ êµ¬ë§¤ </div>
  </a>

  <div class="div6">êµ¬ë§¤ í¬ë§ê°€</div>
  <input type="number"
         id="originPriceInput"
         name="origin_price"
         class="_172-000"
         placeholder="ê¸ˆì•¡ ì…ë ¥"
         style="color: black;"
         oninput="updateLockedKatte()" />
  <div class="div7">â‚©</div>
  <div class="div8">ì˜ˆìˆ˜ê¸ˆ ì ìš©</div>
  <input type="text"
         id="lockedKatteDisplay"
         class="_86-000"
         value=""
         style="color: black;"
         disabled />
  <input type="hidden" id="lockedKatteInput" name="locked_katte" />
  <div class="div9">â‚©</div>
  <div class="rectangle-16182"></div>
  <div class="div10">ë³´ìœ  ë¨¸ë‹ˆí˜„í™©</div>
  <div class="_320-000"
       th:text="${katte_money > 0} ? ${#numbers.formatInteger(katte_money, 3, 'COMMA')} ">
  </div>
  <div class="katte">katte</div>
  <div class="rectangle-16183"></div>
  <div class="div11">ì…ì°° ë§ˆê°ê¸°í•œ</div>
  <div class="_60-2025-07-22"
       th:text="'(' + ${#strings.substring(auctionEndTime, 0, 10).replace('-', '/')} + ' ë§ˆê°)'">
  </div>
  <div class="rectangle-1619"></div>
  <form action="/product/payment" method="post">
    <input type="hidden" name="product_id" th:value="${product.product_id}" />
    <input type="hidden" name="product_name" th:value="${product.product_name}" />
    <input type="hidden" name="brand_name" th:value="${product.brand_name}" />
    <input type="hidden" id="formOriginPrice" name="origin_price" />
    <input type="hidden" name="size" th:value="${size}" />

    <button type="submit" class="div12">êµ¬ë§¤ ì…ì°° ê³„ì†</button>
  </form>
 
</div>
<script>
  // í˜ì´ì§€ê°€ ë¡œë“œëœ ë’¤ì— ì‹¤í–‰
  document.addEventListener("DOMContentLoaded", function() {
    // ëª¨ë“  ë²„íŠ¼ì„ ë°°ì—´ë¡œ ê°€ì ¸ì˜¤ê¸°
    const buttons = document.querySelectorAll(".day-button");

    const meta = document.getElementById("product-meta");
    const productId = meta.dataset.productId;

    const resourceURL = "https://resources-katte.jp.ngrok.io/images/";
    const imagePath = `${resourceURL}${productId}/${productId}_1.png`;

    document.querySelector('.image').src = imagePath;

    buttons.forEach(btn => {
      btn.addEventListener("click", () => {
        // 1) ê¸°ì¡´ì— í™œì„±í™”ëœ ë²„íŠ¼ì—ì„œ active í´ë˜ìŠ¤ ì œê±°
        buttons.forEach(b => b.classList.remove("active"));
        // 2) í´ë¦­í•œ ë²„íŠ¼ì—ë§Œ active í´ë˜ìŠ¤ ì¶”ê°€
        btn.classList.add("active");
      });
    });
  });
  function updateLockedKatte() {
    const origin = parseInt(document.getElementById("originPriceInput").value) || 0;

    // ğŸ’¥ ì´ ì½”ë“œê°€ ëˆ„ë½ë˜ì—ˆìœ¼ë©´ formì—ëŠ” ì•„ë¬´ ê°’ë„ ì „ì†¡ë˜ì§€ ì•ŠìŒ!
    document.getElementById("formOriginPrice").value = origin;
  }

  document.querySelector("form").addEventListener("submit", function(e) {
    const origin = document.getElementById("originPriceInput").value;
    if (!origin || parseInt(origin) <= 0) {
      alert("êµ¬ë§¤ í¬ë§ê°€ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
      e.preventDefault();
      return false;
    }
  });

</script>
</body>
</html>